<!DOCTYPE html>
<html lang=en-US>
<head>
<meta charset=utf-8>
<title>Linux command ip-xfrm</title><meta name="description" content="Linux command ip-xfrm transform configuration"><meta name="keywords" content="linux, command, ip-xfrm, bsd, transform configuration"><meta name="robots" content="index,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="container">

<h1>NAME</h1>
<p>ip-xfrm - transform configuration</p>
<h1>SYNOPSIS</h1>
<p><strong>ip</strong> [ <em>OPTIONS</em> ] <strong>xfrm</strong> { <em>COMMAND</em> | <strong>help</strong> }</p>
<p><strong>ip xfrm</strong> <em>XFRM-OBJECT</em> { <em>COMMAND</em> | <strong>help</strong> }</p>
<p><em>XFRM-OBJECT</em> := <strong>state</strong> | <strong>policy</strong> | <strong>monitor</strong></p>
<p><strong>ip xfrm state</strong> { <strong>add</strong> | <strong>update</strong> } <em>ID</em> [ <em>ALGO-LIST</em> ] [ <strong>mode</strong> <em>MODE</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>seq</strong> <em>SEQ</em> ] [ <strong>replay-window</strong> <em>SIZE</em> ] [ <strong>replay-seq</strong> <em>SEQ</em> ] [ <strong>replay-oseq</strong> <em>SEQ</em> ] [ <strong>replay-seq-hi</strong> <em>SEQ</em> ] [ <strong>replay-oseq-hi</strong> <em>SEQ</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em> ] [ <strong>sel</strong> <em>SELECTOR</em> ] [ <em>LIMIT-LIST</em> ] [ <strong>encap</strong> <em>ENCAP</em> ] [ <strong>coa</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>ctx</strong> <em>CTX</em> ] [ <strong>extra-flag</strong> <em>EXTRA-FLAG-LIST</em> ] [ <strong>output-mark</strong> <em>OUTPUT-MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>if_id</strong> <em>IF-ID</em> ]</p>
<p><strong>ip xfrm state allocspi</strong> <em>ID</em> [ <strong>mode</strong> <em>MODE</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>seq</strong> <em>SEQ</em> ] [ <strong>min</strong> <em>SPI</em> <strong>max</strong> <em>SPI</em> ]</p>
<p><strong>ip xfrm state</strong> { <strong>delete</strong> | <strong>get</strong> } <em>ID</em> [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ]</p>
<p><strong>ip</strong> [ <strong>-4</strong> | <strong>-6</strong> ] <strong>xfrm state deleteall</strong> [ <em>ID</em> ] [ <strong>mode</strong> <em>MODE</em> ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em> ]</p>
<p><strong>ip</strong> [ <strong>-4</strong> | <strong>-6</strong> ] <strong>xfrm state list</strong> [ <em>ID</em> ] [ <strong>nokeys</strong> ] [ <strong>mode</strong> <em>MODE</em> ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em> ]</p>
<p><strong>ip xfrm state flush</strong> [ <strong>proto</strong> <em>XFRM-PROTO</em> ]</p>
<p><strong>ip xfrm state count</strong></p>
<p><em>ID</em> := [ <strong>src</strong> <em>ADDR</em> ] [ <strong>dst</strong> <em>ADDR</em> ] [ <strong>proto</strong> <em>XFRM-PROTO</em> ] [ <strong>spi</strong> <em>SPI</em> ]</p>
<p><em>XFRM-PROTO</em> := <strong>esp</strong> | <strong>ah</strong> | <strong>comp</strong> | <strong>route2</strong> | <strong>hao</strong></p>
<p><em>ALGO-LIST</em> := [ <em>ALGO-LIST</em> ] <em>ALGO</em></p>
<p><em>ALGO</em> := { <strong>enc</strong> | <strong>auth</strong> } <em>ALGO-NAME</em> <em>ALGO-KEYMAT</em> |<br />
<strong>auth-trunc</strong> <em>ALGO-NAME</em> <em>ALGO-KEYMAT</em> <em>ALGO-TRUNC-LEN</em> |<br />
<strong>aead</strong> <em>ALGO-NAME</em> <em>ALGO-KEYMAT</em> <em>ALGO-ICV-LEN</em> |<br />
<strong>comp</strong> <em>ALGO-NAME</em></p>
<p><em>MODE</em> := <strong>transport</strong> | <strong>tunnel</strong> | <strong>beet</strong> | <strong>ro</strong> | <strong>in_trigger</strong></p>
<p><em>FLAG-LIST</em> := [ <em>FLAG-LIST</em> ] <em>FLAG</em></p>
<p><em>FLAG</em> := <strong>noecn</strong> | <strong>decap-dscp</strong> | <strong>nopmtudisc</strong> | <strong>wildrecv</strong> | <strong>icmp</strong> | <strong>af-unspec</strong> | <strong>align4</strong> | <strong>esn</strong></p>
<p><em>SELECTOR</em> := [ <strong>src</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dst</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dev</strong> <em>DEV</em> ]<br />
[ <em>UPSPEC</em> ]</p>
<p><em>UPSPEC</em> := <strong>proto</strong> { <em>PROTO</em> |<br />
{ <strong>tcp</strong> | <strong>udp</strong> | <strong>sctp</strong> | <strong>dccp</strong> } [ <strong>sport</strong> <em>PORT</em> ] [ <strong>dport</strong> <em>PORT</em> ] |<br />
{ <strong>icmp</strong> | <strong>ipv6-icmp</strong> | <strong>mobility-header</strong> } [ <strong>type</strong> <em>NUMBER</em> ] [ <strong>code</strong> <em>NUMBER</em> ] |<br />
<strong>gre</strong> [ <strong>key</strong> { <em>DOTTED-QUAD</em> | <em>NUMBER</em> } ] }</p>
<p><em>LIMIT-LIST</em> := [ <em>LIMIT-LIST</em> ] <strong>limit</strong> <em>LIMIT</em></p>
<p><em>LIMIT</em> := { <strong>time-soft</strong> | <strong>time-hard</strong> | <strong>time-use-soft</strong> | <strong>time-use-hard</strong> } <em>SECONDS</em> |<br />
{ <strong>byte-soft</strong> | <strong>byte-hard</strong> } <em>SIZE</em> |<br />
{ <strong>packet-soft</strong> | <strong>packet-hard</strong> } <em>COUNT</em></p>
<p><em>ENCAP</em> := { <strong>espinudp</strong> | <strong>espinudp-nonike</strong> | <strong>espintcp</strong> } <em>SPORT</em> <em>DPORT</em> <em>OADDR</em></p>
<p><em>EXTRA-FLAG-LIST</em> := [ <em>EXTRA-FLAG-LIST</em> ] <em>EXTRA-FLAG</em></p>
<p><em>EXTRA-FLAG</em> := <strong>dont-encap-dscp</strong> | <strong>oseq-may-wrap</strong></p>
<p><strong>ip xfrm policy</strong> { <strong>add</strong> | <strong>update</strong> } <em>SELECTOR</em> <strong>dir</strong> <em>DIR</em> [ <strong>ctx</strong> <em>CTX</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>index</strong> <em>INDEX</em> ] [ <strong>ptype</strong> <em>PTYPE</em> ] [ <strong>action</strong> <em>ACTION</em> ] [ <strong>priority</strong> <em>PRIORITY</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em> ] [ <strong>if_id</strong> <em>IF-ID</em> ] [ <em>LIMIT-LIST</em> ] [ <em>TMPL-LIST</em> ]</p>
<p><strong>ip xfrm policy</strong> { <strong>delete</strong> | <strong>get</strong> } { <em>SELECTOR</em> | <strong>index</strong> <em>INDEX</em> } <strong>dir</strong> <em>DIR</em> [ <strong>ctx</strong> <em>CTX</em> ] [ <strong>mark</strong> <em>MARK</em> [ <strong>mask</strong> <em>MASK</em> ] ] [ <strong>ptype</strong> <em>PTYPE</em> ] [ <strong>if_id</strong> <em>IF-ID</em> ]</p>
<p><strong>ip</strong> [ <strong>-4</strong> | <strong>-6</strong> ] <strong>xfrm policy</strong> { <strong>deleteall</strong> | <strong>list</strong> } [ <strong>nosock</strong> ] [ <em>SELECTOR</em> ] [ <strong>dir</strong> <em>DIR</em> ] [ <strong>index</strong> <em>INDEX</em> ] [ <strong>ptype</strong> <em>PTYPE</em> ] [ <strong>action</strong> <em>ACTION</em> ] [ <strong>priority</strong> <em>PRIORITY</em> ] [ <strong>flag</strong> <em>FLAG-LIST</em>]</p>
<p><strong>ip xfrm policy flush</strong> [ <strong>ptype</strong> <em>PTYPE</em> ]</p>
<p><strong>ip xfrm policy count</strong></p>
<p><strong>ip xfrm policy set</strong> [ <strong>hthresh4</strong> <em>LBITS</em> <em>RBITS</em> ] [ <strong>hthresh6</strong> <em>LBITS</em> <em>RBITS</em> ]</p>
<p><em>SELECTOR</em> := [ <strong>src</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dst</strong> <em>ADDR</em>[/<em>PLEN</em>] ] [ <strong>dev</strong> <em>DEV</em> ] [ <em>UPSPEC</em> ]</p>
<p><em>UPSPEC</em> := <strong>proto</strong> { <em>PROTO</em> |<br />
{ <strong>tcp</strong> | <strong>udp</strong> | <strong>sctp</strong> | <strong>dccp</strong> } [ <strong>sport</strong> <em>PORT</em> ] [ <strong>dport</strong> <em>PORT</em> ] |<br />
{ <strong>icmp</strong> | <strong>ipv6-icmp</strong> | <strong>mobility-header</strong> } [ <strong>type</strong> <em>NUMBER</em> ] [ <strong>code</strong> <em>NUMBER</em> ] |<br />
<strong>gre</strong> [ <strong>key</strong> { <em>DOTTED-QUAD</em> | <em>NUMBER</em> } ] }</p>
<p><em>DIR</em> := <strong>in</strong> | <strong>out</strong> | <strong>fwd</strong></p>
<p><em>PTYPE</em> := <strong>main</strong> | <strong>sub</strong></p>
<p><em>ACTION</em> := <strong>allow</strong> | <strong>block</strong></p>
<p><em>FLAG-LIST</em> := [ <em>FLAG-LIST</em> ] <em>FLAG</em></p>
<p><em>FLAG</em> := <strong>localok</strong> | <strong>icmp</strong></p>
<p><em>LIMIT-LIST</em> := [ <em>LIMIT-LIST</em> ] <strong>limit</strong> <em>LIMIT</em></p>
<p><em>LIMIT</em> := { <strong>time-soft</strong> | <strong>time-hard</strong> | <strong>time-use-soft</strong> | <strong>time-use-hard</strong> } <em>SECONDS</em> |<br />
{ <strong>byte-soft</strong> | <strong>byte-hard</strong> } <em>SIZE</em> |<br />
{ <strong>packet-soft</strong> | <strong>packet-hard</strong> } <em>COUNT</em></p>
<p><em>TMPL-LIST</em> := [ <em>TMPL-LIST</em> ] <strong>tmpl</strong> <em>TMPL</em></p>
<p><em>TMPL</em> := <em>ID</em> [ <strong>mode</strong> <em>MODE</em> ] [ <strong>reqid</strong> <em>REQID</em> ] [ <strong>level</strong> <em>LEVEL</em> ]</p>
<p><em>ID</em> := [ <strong>src</strong> <em>ADDR</em> ] [ <strong>dst</strong> <em>ADDR</em> ] [ <strong>proto</strong> <em>XFRM-PROTO</em> ] [ <strong>spi</strong> <em>SPI</em> ]</p>
<p><em>XFRM-PROTO</em> := <strong>esp</strong> | <strong>ah</strong> | <strong>comp</strong> | <strong>route2</strong> | <strong>hao</strong></p>
<p><em>MODE</em> := <strong>transport</strong> | <strong>tunnel</strong> | <strong>beet</strong> | <strong>ro</strong> | <strong>in_trigger</strong></p>
<p><em>LEVEL</em> := <strong>required</strong> | <strong>use</strong></p>
<p><strong>ip xfrm monitor</strong> [ <strong>all-nsid</strong> ] [ <strong>nokeys</strong> ] [ <strong>all</strong> | <em>LISTofXFRM-OBJECTS</em> ]</p>
<p><em>LISTofXFRM-OBJECTS</em> := [ <em>LISTofXFRM-OBJECTS</em> ] <em>XFRM-OBJECT</em></p>
<p><em>XFRM-OBJECT</em> := <strong>acquire</strong> | <strong>expire</strong> | <strong>SA</strong> | <strong>policy</strong> | <strong>aevent</strong> | <strong>report</strong></p>
<h1>DESCRIPTION</h1>
<p>xfrm is an IP framework for transforming packets (such as encrypting their payloads). This framework is used to implement the IPsec protocol suite (with the <strong>state</strong> object operating on the Security Association Database, and the <strong>policy</strong> object operating on the Security Policy Database). It is also used for the IP Payload Compression Protocol and features of Mobile IPv6.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">ip xfrm state add</td>
<td style="text-align: left;">add new state into xfrm</td>
</tr>
<tr class="even">
<td style="text-align: left;">ip xfrm state update</td>
<td style="text-align: left;">update existing state in xfrm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ip xfrm state allocspi</td>
<td style="text-align: left;">allocate an SPI value</td>
</tr>
<tr class="even">
<td style="text-align: left;">ip xfrm state delete</td>
<td style="text-align: left;">delete existing state in xfrm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ip xfrm state get</td>
<td style="text-align: left;">get existing state in xfrm</td>
</tr>
<tr class="even">
<td style="text-align: left;">ip xfrm state deleteall</td>
<td style="text-align: left;">delete all existing state in xfrm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ip xfrm state list</td>
<td style="text-align: left;">print out the list of existing state in xfrm</td>
</tr>
<tr class="even">
<td style="text-align: left;">ip xfrm state flush</td>
<td style="text-align: left;">flush all state in xfrm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ip xfrm state count</td>
<td style="text-align: left;">count all existing state in xfrm</td>
</tr>
</tbody>
</table>
<dl>
<dt><em>ID</em></dt>
<dd><p>is specified by a source address, destination address, transform protocol <em>XFRM-PROTO</em>, and/or Security Parameter Index <em>SPI</em>. (For IP Payload Compression, the Compression Parameter Index or CPI is used for <em>SPI</em>.)</p>
</dd>
</dl>
<dl>
<dt><em>XFRM-PROTO</em></dt>
<dd><p>specifies a transform protocol: IPsec Encapsulating Security Payload (<strong>esp</strong>), IPsec Authentication Header (<strong>ah</strong>), IP Payload Compression (<strong>comp</strong>), Mobile IPv6 Type 2 Routing Header (<strong>route2</strong>), or Mobile IPv6 Home Address Option (<strong>hao</strong>).</p>
</dd>
</dl>
<dl>
<dt><em>ALGO-LIST</em></dt>
<dd><p>contains one or more algorithms to use. Each algorithm <em>ALGO</em> is specified by:</p>
<ul>
<li><p>the algorithm type: encryption (<strong>enc</strong>), authentication (<strong>auth</strong> or <strong>auth-trunc</strong>), authenticated encryption with associated data (<strong>aead</strong>), or compression (<strong>comp</strong>)</p></li>
<li><p>the algorithm name <em>ALGO-NAME</em> (see below)</p></li>
<li><p>(for all except <strong>comp</strong>) the keying material <em>ALGO-KEYMAT</em>, which may include both a key and a salt or nonce value; refer to the corresponding RFC</p></li>
<li><p>(for <strong>auth-trunc</strong> only) the truncation length <em>ALGO-TRUNC-LEN</em> in bits</p></li>
<li><p>(for <strong>aead</strong> only) the Integrity Check Value length <em>ALGO-ICV-LEN</em> in bits</p></li>
</ul>
</dd>
</dl>
<blockquote>
<p>Encryption algorithms include <strong>ecb(cipher_null)</strong>, <strong>cbc(des)</strong>, <strong>cbc(des3_ede)</strong>, <strong>cbc(cast5)</strong>, <strong>cbc(blowfish)</strong>, <strong>cbc(aes)</strong>, <strong>cbc(serpent)</strong>, <strong>cbc(camellia)</strong>, <strong>cbc(twofish)</strong>, and <strong>rfc3686(ctr(aes))</strong>.</p>
<p>Authentication algorithms include <strong>digest_null</strong>, <strong>hmac(md5)</strong>, <strong>hmac(sha1)</strong>, <strong>hmac(sha256)</strong>, <strong>hmac(sha384)</strong>, <strong>hmac(sha512)</strong>, <strong>hmac(rmd160)</strong>, and <strong>xcbc(aes)</strong>.</p>
<p>Authenticated encryption with associated data (AEAD) algorithms include <strong>rfc4106(gcm(aes))</strong>, <strong>rfc4309(ccm(aes))</strong>, and <strong>rfc4543(gcm(aes))</strong>.</p>
<p>Compression algorithms include <strong>deflate</strong>, <strong>lzs</strong>, and <strong>lzjh</strong>.</p>
</blockquote>
<dl>
<dt><em>MODE</em></dt>
<dd><p>specifies a mode of operation for the transform protocol. IPsec and IP Payload Compression modes are <strong>transport</strong>, <strong>tunnel</strong>, and (for IPsec ESP only) Bound End-to-End Tunnel (<strong>beet</strong>). Mobile IPv6 modes are route optimization (<strong>ro</strong>) and inbound trigger (<strong>in_trigger</strong>).</p>
</dd>
</dl>
<dl>
<dt><em>FLAG-LIST</em></dt>
<dd><p>contains one or more of the following optional flags: <strong>noecn</strong>, <strong>decap-dscp</strong>, <strong>nopmtudisc</strong>, <strong>wildrecv</strong>, <strong>icmp</strong>, <strong>af-unspec</strong>, <strong>align4</strong>, or <strong>esn</strong>.</p>
</dd>
</dl>
<dl>
<dt><em>SELECTOR</em></dt>
<dd><p>selects the traffic that will be controlled by the policy, based on the source address, the destination address, the network device, and/or <em>UPSPEC</em>.</p>
</dd>
</dl>
<dl>
<dt><em>UPSPEC</em></dt>
<dd><p>selects traffic by protocol. For the <strong>tcp</strong>, <strong>udp</strong>, <strong>sctp</strong>, or <strong>dccp</strong> protocols, the source and destination port can optionally be specified. For the <strong>icmp</strong>, <strong>ipv6-icmp</strong>, or <strong>mobility-header</strong> protocols, the type and code numbers can optionally be specified. For the <strong>gre</strong> protocol, the key can optionally be specified as a dotted-quad or number. Other protocols can be selected by name or number <em>PROTO</em>.</p>
</dd>
</dl>
<dl>
<dt><em>LIMIT-LIST</em></dt>
<dd><p>sets limits in seconds, bytes, or numbers of packets.</p>
</dd>
</dl>
<dl>
<dt><em>ENCAP</em></dt>
<dd><p>encapsulates packets with protocol <strong>espinudp</strong>, <strong>espinudp-nonike</strong>, or <strong>espintcp</strong>, using source port <em>SPORT</em>, destination port <em>DPORT</em> , and original address <em>OADDR</em>.</p>
</dd>
</dl>
<dl>
<dt><em>MARK</em></dt>
<dd><p>used to match xfrm policies and states</p>
</dd>
</dl>
<dl>
<dt><em>OUTPUT-MARK</em></dt>
<dd><p>used to set the output mark to influence the routing of the packets emitted by the state</p>
</dd>
</dl>
<dl>
<dt><em>IF-ID</em></dt>
<dd><p>xfrm interface identifier used to in both xfrm policies and states</p>
</dd>
</dl>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">ip xfrm policy add</td>
<td style="text-align: left;">add a new policy</td>
</tr>
<tr class="even">
<td style="text-align: left;">ip xfrm policy update</td>
<td style="text-align: left;">update an existing policy</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ip xfrm policy delete</td>
<td style="text-align: left;">delete an existing policy</td>
</tr>
<tr class="even">
<td style="text-align: left;">ip xfrm policy get</td>
<td style="text-align: left;">get an existing policy</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ip xfrm policy deleteall</td>
<td style="text-align: left;">delete all existing xfrm policies</td>
</tr>
<tr class="even">
<td style="text-align: left;">ip xfrm policy list</td>
<td style="text-align: left;">print out the list of xfrm policies</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ip xfrm policy flush</td>
<td style="text-align: left;">flush policies</td>
</tr>
</tbody>
</table>
<dl>
<dt><strong>nosock</strong></dt>
<dd><p>filter (remove) all socket policies from the output.</p>
</dd>
</dl>
<dl>
<dt><em>SELECTOR</em></dt>
<dd><p>selects the traffic that will be controlled by the policy, based on the source address, the destination address, the network device, and/or <em>UPSPEC</em>.</p>
</dd>
</dl>
<dl>
<dt><em>UPSPEC</em></dt>
<dd><p>selects traffic by protocol. For the <strong>tcp</strong>, <strong>udp</strong>, <strong>sctp</strong>, or <strong>dccp</strong> protocols, the source and destination port can optionally be specified. For the <strong>icmp</strong>, <strong>ipv6-icmp</strong>, or <strong>mobility-header</strong> protocols, the type and code numbers can optionally be specified. For the <strong>gre</strong> protocol, the key can optionally be specified as a dotted-quad or number. Other protocols can be selected by name or number <em>PROTO</em>.</p>
</dd>
</dl>
<dl>
<dt><em>DIR</em></dt>
<dd><p>selects the policy direction as <strong>in</strong>, <strong>out</strong>, or <strong>fwd</strong>.</p>
</dd>
</dl>
<dl>
<dt><em>CTX</em></dt>
<dd><p>sets the security context.</p>
</dd>
</dl>
<dl>
<dt><em>PTYPE</em></dt>
<dd><p>can be <strong>main</strong> (default) or <strong>sub</strong>.</p>
</dd>
</dl>
<dl>
<dt><em>ACTION</em></dt>
<dd><p>can be <strong>allow</strong> (default) or <strong>block</strong>.</p>
</dd>
</dl>
<dl>
<dt><em>PRIORITY</em></dt>
<dd><p>is a number that defaults to zero.</p>
</dd>
</dl>
<dl>
<dt><em>FLAG-LIST</em></dt>
<dd><p>contains one or both of the following optional flags: <strong>local</strong> or <strong>icmp</strong>.</p>
</dd>
</dl>
<dl>
<dt><em>LIMIT-LIST</em></dt>
<dd><p>sets limits in seconds, bytes, or numbers of packets.</p>
</dd>
</dl>
<dl>
<dt><em>TMPL-LIST</em></dt>
<dd><p>is a template list specified using <em>ID</em>, <em>MODE</em>, <em>REQID</em>, and/or <em>LEVEL</em>. </p>
</dd>
</dl>
<dl>
<dt><em>ID</em></dt>
<dd><p>is specified by a source address, destination address, transform protocol <em>XFRM-PROTO</em>, and/or Security Parameter Index <em>SPI</em>. (For IP Payload Compression, the Compression Parameter Index or CPI is used for <em>SPI</em>.)</p>
</dd>
</dl>
<dl>
<dt><em>XFRM-PROTO</em></dt>
<dd><p>specifies a transform protocol: IPsec Encapsulating Security Payload (<strong>esp</strong>), IPsec Authentication Header (<strong>ah</strong>), IP Payload Compression (<strong>comp</strong>), Mobile IPv6 Type 2 Routing Header (<strong>route2</strong>), or Mobile IPv6 Home Address Option (<strong>hao</strong>).</p>
</dd>
</dl>
<dl>
<dt><em>MODE</em></dt>
<dd><p>specifies a mode of operation for the transform protocol. IPsec and IP Payload Compression modes are <strong>transport</strong>, <strong>tunnel</strong>, and (for IPsec ESP only) Bound End-to-End Tunnel (<strong>beet</strong>). Mobile IPv6 modes are route optimization (<strong>ro</strong>) and inbound trigger (<strong>in_trigger</strong>).</p>
</dd>
</dl>
<dl>
<dt><em>LEVEL</em></dt>
<dd><p>can be <strong>required</strong> (default) or <strong>use</strong>.</p>
</dd>
</dl>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">ip xfrm policy count</td>
<td style="text-align: left;">count existing policies</td>
</tr>
</tbody>
</table>
<p>Use one or more -s options to display more details, including policy hash table information.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">ip xfrm policy set</td>
<td style="text-align: left;">configure the policy hash table</td>
</tr>
</tbody>
</table>
<p>Security policies whose address prefix lengths are greater than or equal policy hash table thresholds are hashed. Others are stored in the policy_inexact chained list.</p>
<dl>
<dt><em>LBITS</em></dt>
<dd><p>specifies the minimum local address prefix length of policies that are stored in the Security Policy Database hash table.</p>
</dd>
</dl>
<dl>
<dt><em>RBITS</em></dt>
<dd><p>specifies the minimum remote address prefix length of policies that are stored in the Security Policy Database hash table.</p>
</dd>
</dl>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">ip xfrm monitor</td>
<td style="text-align: left;">state monitoring for xfrm objects</td>
</tr>
</tbody>
</table>
<p>The xfrm objects to monitor can be optionally specified.</p>
<p>If the <strong>all-nsid</strong> option is set, the program listens to all network namespaces that have a nsid assigned into the network namespace were the program is running. A prefix is displayed to show the network namespace where the message originates. Example:</p>
<p>[nsid 1]Flushed state proto 0</p>
<h1>AUTHOR</h1>
<p>Manpage revised by David Ward &lt;david.ward@ll.mit.edu&gt;<br />
Manpage revised by Christophe Gouault &lt;christophe.gouault@6wind.com&gt;<br />
Manpage revised by Nicolas Dichtel &lt;nicolas.dichtel@6wind.com&gt;</p>
<footer style="text-align: center;"><a href="https://blog.tamer.pw" target="_blank">Blog</a> | <a href="https://github.com/linuxtamer" target="_blank">Contact</a></footer>
</div>
</body>
</html>

